apiVersion: v1
kind: Secret
metadata:
  name: basic-user-pass
  annotations:
    build.knative.dev/docker-0: https://index.docker.io/v1/
type: kubernetes.io/basic-auth
data:
  username: anVzdGluMjk5Nw==
  password: ZmluYWZpMzM=
---
apiVersion: v1
kind: ServiceAccount
metadata:
  name: build-bot
secrets:
  - name: basic-user-pass
---
apiVersion: serving.knative.dev/v1alpha1
kind: Service
metadata:
  name: logger1
spec:
  runLatest:
    configuration:
      build:
        apiVersion: build.knative.dev/v1alpha1
        kind: Build
        spec:
          serviceAccountName: build-bot
          source:
            git:
              url: https://github.com/Justin2997/RabbitMQ-Knative-Event-Source/tree/master/logger
              revision: master
          template:
            name: kaniko
            arguments:
              - name: justin2997/knative-rabbitmq-logger
                value: docker.io/justin2997/knative-rabbitmq-logger:latest
      revisionTemplate:
        spec:
          container:
            image: docker.io/justin2997/knative-rabbitmq-logger
            imagePullPolicy: Always
---
apiVersion: serving.knative.dev/v1alpha1
kind: Service
metadata:
  name: logger2
spec:
  runLatest:
    configuration:
      revisionTemplate:
        spec:
          container:
            image: justin2997/knative-rabbitmq-logger
---
apiVersion: serving.knative.dev/v1alpha1
kind: Service
metadata:
  name: logger3
spec:
  runLatest:
    configuration:
      revisionTemplate:
        spec:
          container:
            image: justin2997/knative-rabbitmq-logger
---
apiVersion: sources.eventing.knative.dev/v1alpha1
kind: ContainerSource
metadata:
  labels:
    controller-tools.k8s.io: "1.0"
  name: rabbitmq-evensource
spec:
  image: docker.io/justin2997/knative-rabbitmq-event-source-worker
  imagePullPolicy: Always
  args:
    - '--name=worker1'
  sink:
    apiVersion: serving.knative.dev/v1alpha1
    kind: Service
    name: logger1